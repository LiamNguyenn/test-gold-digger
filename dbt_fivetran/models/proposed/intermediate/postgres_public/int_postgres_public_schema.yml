version: 2

models:
  - name: int_enrich_eh_users
    description: "This intermediate model joins the postgres_public.users table with the postgres_public.user_infos and postgres_public.members table to enrich the user data with additional fields"
    meta: 
      upstream_system_owner: "squad-platform"
      data_owner: "gold-diggers"
    columns:
      - name: eh_user_id
        description: The user ID generated by the EH platform
      - name: eh_user_uuid
        description: The user UUID generated by the EH platform
      - name: ebenefits_user_uuid
        description: The user UUID generated by the ebenefits platform
      - name: first_name
        description: The first name of the user
      - name: last_name
        description: The last name of the user
      - name: email
        description: The email address of the user
        meta:
          sensitive: true
          masking_rules:
            full_mask:
              mask_function: sha2-256
      - name: has_acknowledged_eh_tnc
        description: A boolean flag to indicate whether the user has acknowledged the EH platform's terms and conditions
      - name: is_twofa_enabled
        description: A boolean flag to indicate whether the user has enabled two-factor authentication
      - name: is_verified
        description: A boolean flag to indicate whether the user's profile has been successfully verified
      - name: verified_at
        description: The timestamp of when the user's profile was verified
      - name: is_profile_completed
        description: A boolean flag to indicate whether the user has completed their profile
      - name: is_public_profile
        description: A boolean flag to indicate whether the user has set their profile to be searchable publicly
      - name: is_active
        description: A boolean flag to indicate whether the user's profile is active; this is currently simply assumed to be true as long as the profile has been activated once
      - name: activated_at
        description: The timestamp of when the user's profile was activated
      - name: is_marketing_consented
        description: A boolean flag to indicate whether the user has consented to marketing communications
      - name: marketing_consented_at
        description: The timestamp of when the user consented to marketing communications
      - name: created_at
        description: The timestamp of when the user's profile was created
      - name: is_current_eh_employee
        description: A boolean flag to indicate whether the user is currently an internal EH employee
      - name: is_active_employee
        description: A boolean flag to indicate whether the user is currently associated to at least 1 active employee record in the EH platform
      - name: active_employee_count
        description: The number of active employee records associated with the user in the EH platform
      - name: terminated_employee_count
        description: The number of terminated employee records associated with the user in the EH platform