version: 2

models:
  - name: int_enrich_keypay_users
    description: |
      This intermediate table filters **all** user records in the Keypay payroll platform based on the most recent data extraction date. 

      This model has been enriched with additional fields to determine the number of active employees associated with the user profile.
      
      This model only contains all user profiles generated within the Keypay payroll platform and not from the main EH platform.
    meta: 
      upstream_system_owner: "keypay"
      data_owner: "gold-diggers"
    columns:
      - name: keypay_user_id
        description: The user ID generated by the Keypay platform
      - name: first_name
        description: The first name of the user
      - name: last_name
        description: The last name of the user
      - name: email
        description: The email address of the user
        meta:
          sensitive: true
          masking_rules:
            full_mask:
              mask_function: sha2-256
      - name: is_active
        description: A boolean flag to indicate whether the user's profile is active; this is currently simply assumed to be true as long as the profile has been activated once
      - name: is_admin
        description: A boolean flag to indicate whether the user is an admin in the Keypay payroll platform
      - name: ebenefits_user_uuid
        description: The user UUID generated by the ebenefits platform
      - name: is_current_eh_employee
        description: A boolean flag to indicate whether the user is currently an internal EH employee
      - name: is_active_employee
        description: A boolean flag to indicate whether the user is currently an active employee in the Keypay payroll platform
      - name: active_employee_count
        description: The number of active employee records associated with the user in the Keypay payroll platform
      - name: terminated_employee_count
        description: The number of terminated employee records associated with the user in the Keypay payroll platform
      